(function(){"use strict";var e={1627:function(e,t,o){var n=o(9963),c=o(6252),i=o(3577);const a=(0,c._)("p",null,"Simple call example",-1),d={class:"form"},r={class:"joinF"},s={class:"camera"},l={id:"video-div"},u=(0,c._)("p",null,"local video",-1),m=[u],h={id:"remote-media-div"},v=(0,c._)("p",null,"remote video",-1),p=[v];function f(e,t,o,u,v,f){return(0,c.wg)(),(0,c.iD)(c.HY,null,[a,(0,c._)("div",d,[(0,c._)("div",r,[(0,c.wy)((0,c._)("input",{type:"text","onUpdate:modelValue":t[0]||(t[0]=e=>v.roomId=e),placeholder:"roomId"},null,512),[[n.nr,v.roomId]]),(0,c._)("div",null,[(0,c._)("button",{onClick:t[1]||(t[1]=e=>f.createRoom()),id:"try-video-button"}," Create room "),(0,c._)("button",{onClick:t[2]||(t[2]=e=>f.connectToRoom()),id:"stop-video-button"}," Join room "),(0,c._)("button",{class:(0,i.C_)(["enable",{connected:v.isConnected},{created:v.isCreated}]),id:"toggle-video"}," Enable ",2)])]),(0,c._)("div",s,[(0,c.wy)((0,c._)("div",l,m,512),[[n.F8,v.localVideo]]),(0,c.wy)((0,c._)("div",h,p,512),[[n.F8,v.remoteVideo]])])])],64)}var b=o(8445),k=o.n(b),g=o(6154),y=o(9755),C=o.n(y),E={name:"HomeView",data(){return{roomId:"",TOKEN:"",indent:"",localVideo:!0,remoteVideo:!0,isConnected:!1,isCreated:!1,videoTodge:!1,connectedInd:0,localVideoTrackCreated:!1}},mounted(){},methods:{async createRoom(){const e=await this.getAccessToken();(0,b.createLocalTracks)({audio:!0,video:{width:640}}).then((t=>(0,b.connect)(e,{name:this.roomId,tracks:t}))).then((e=>{console.log(`Connected to Room: ${e.name}`),this.isCreated=!0,e.on("participantConnected",(t=>{function o(e){e.on("enabled",(()=>{console.log(28310982138019834e9)}))}t.tracks.forEach((e=>{if(e.isSubscribed){const t=e.track;document.getElementById("remote-media-div").appendChild(t.attach())}})),e.participants.forEach((e=>{e.tracks.forEach((e=>{if(e.isSubscribed){const t=e.track;document.getElementById("remote-media-div").appendChild(t.attach()),C()("#remote-media-div video").remove()}})),e.on("trackSubscribed",(e=>{document.getElementById("remote-media-div").appendChild(e.attach()),C()("#remote-media-div video").remove()})),C()("#remote-media-div video").remove()})),C()("#remote-media-div video").remove(),console.log(`Participant "${t.identity}" connected`),t.on("trackSubscribed",(e=>{2==this.connectedInd?(t.tracks.forEach((e=>{if(this.connectedInd+=1,e.isSubscribed){const t=e.track;C()("#remote-media-div VIDEO").remove(),document.getElementById("remote-media-div").appendChild(t.attach()),console.log("remote-media")}})),this.connectedInd+=1):this.connectedInd+=1,console.log("new web")})),C()(".enable").click((function(){(0,b.createLocalVideoTrack)().then((t=>(1!=this.localVideoTrackCreated&&(k().createLocalVideoTrack().then((function(e){const t=e.attach();document.getElementById("video-div").appendChild(t)})),this.localVideoTrackCreated=!0),e.localParticipant.videoTracks.forEach((e=>{console.log(213123123),e.track.enable()})),e.participants.forEach((e=>{e.tracks.forEach((e=>{e.isSubscribed&&o(e.track),e.on("subscribed",o)}))})),e.localParticipant.publishTrack(t)))).then((e=>{console.log("Successfully unmuted your video:",e)}))}))}))}))},async connectToRoom(){const e=await this.getAccessToken();(0,b.connect)(e,{audio:!0,name:this.roomId,video:{width:640}}).then((e=>{console.log(`Connected to Room: ${e.name}`),this.isConnected=!0,e.on("participantConnected",(e=>{e.tracks.forEach((e=>{if(e.isSubscribed){const t=e.track;document.getElementById("remote-media-div").appendChild(t.attach())}}))})),e.participants.forEach((t=>{function o(e){e.on("enabled",(()=>{}))}t.tracks.forEach((e=>{if(e.isSubscribed){const t=e.track;document.getElementById("remote-media-div").appendChild(t.attach()),C()("#remote-media-div video").remove()}})),t.on("trackSubscribed",(e=>{document.getElementById("remote-media-div").appendChild(e.attach()),C()("#remote-media-div video").remove()})),C()("#remote-media-div video").remove(),t.on("trackSubscribed",(e=>{2==this.connectedInd?(C()("#remote-media-div audio"),t.tracks.forEach((e=>{C()("#remote-media-div VIDEO").remove();const t=e.track;document.getElementById("remote-media-div").appendChild(t.attach())})),this.connectedInd+=1):this.connectedInd+=1})),e.participants.forEach((e=>{e.tracks.forEach((e=>{e.isSubscribed&&o(e.track),e.on("subscribed",o)}))})),C()(".enable").click((async function(){C()(".enable").hasClass("connected")&&(0,b.createLocalVideoTrack)().then((t=>(1!=this.localVideoTrackCreated&&(k().createLocalVideoTrack().then((function(e){const t=e.attach();document.getElementById("video-div").appendChild(t)})),this.localVideoTrackCreated=!0),e.localParticipant.videoTracks.forEach((e=>{e.track.enable()})),e.localParticipant.publishTrack(t)))).then((e=>{}))}))}))}))},stopVideoOnly(e){e.getTracks().forEach((e=>{"live"==e.readyState&&"video"===e.kind&&e.stop()}))},async createLocalVideoTrackFunc(e){k().createLocalVideoTrack().then((function(e){const t=e.attach();document.getElementById("video-div").appendChild(t)}))},disableCamera(){k().createLocalVideoTrack().then((function(e){const t=e.attach();document.getElementById("video-div").appendChild(t)}))},async getAccessToken(){const e=await g.Z.get(`http://localhost:3000/token?identity=${Date.now()}`);return this.TOKEN=String(e.data.token),String(e.data.token)}}},T=o(3744);const I=(0,T.Z)(E,[["render",f]]);var w=I,V=o(3907),O=(0,V.MT)({state:{},getters:{},mutations:{},actions:{},modules:{}});(0,n.ri)(w).use(O).mount("#app")}},t={};function o(n){var c=t[n];if(void 0!==c)return c.exports;var i=t[n]={exports:{}};return e[n].call(i.exports,i,i.exports,o),i.exports}o.m=e,function(){var e=[];o.O=function(t,n,c,i){if(!n){var a=1/0;for(l=0;l<e.length;l++){n=e[l][0],c=e[l][1],i=e[l][2];for(var d=!0,r=0;r<n.length;r++)(!1&i||a>=i)&&Object.keys(o.O).every((function(e){return o.O[e](n[r])}))?n.splice(r--,1):(d=!1,i<a&&(a=i));if(d){e.splice(l--,1);var s=c();void 0!==s&&(t=s)}}return t}i=i||0;for(var l=e.length;l>0&&e[l-1][2]>i;l--)e[l]=e[l-1];e[l]=[n,c,i]}}(),function(){o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,{a:t}),t}}(),function(){o.d=function(e,t){for(var n in t)o.o(t,n)&&!o.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})}}(),function(){o.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){var e={143:0};o.O.j=function(t){return 0===e[t]};var t=function(t,n){var c,i,a=n[0],d=n[1],r=n[2],s=0;if(a.some((function(t){return 0!==e[t]}))){for(c in d)o.o(d,c)&&(o.m[c]=d[c]);if(r)var l=r(o)}for(t&&t(n);s<a.length;s++)i=a[s],o.o(e,i)&&e[i]&&e[i][0](),e[i]=0;return o.O(l)},n=self["webpackChunkvideo"]=self["webpackChunkvideo"]||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))}();var n=o.O(void 0,[998],(function(){return o(1627)}));n=o.O(n)})();
//# sourceMappingURL=app.fd0655cd.js.map